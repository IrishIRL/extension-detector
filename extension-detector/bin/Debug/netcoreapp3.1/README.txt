Used https://github.com/GetoXs/MimeDetect/tree/master/src/Winista.MimeDetect 
Hopefully it is okey and I did not need to invent something new.